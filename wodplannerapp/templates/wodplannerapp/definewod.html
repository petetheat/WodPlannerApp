<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">

{% load static %}

<link rel="stylesheet" type="text/css" href="{% static 'wodplannerapp/style.css' %}">

<style class="_styletron_hydrate_">._ce:hover{border-color:#000000}._a{font-family:"Helvetica Neue", Helvetica, Arial, sans-serif}._b{position:absolute}._n{position:relative}._c{left:0}._d{right:0}._e{top:0}._f{bottom:0}._g{height:100%}._az{height:24px}._bl{height:40px}._bt{height:100px}._d1{height:18px}._d8{height:56px}._h{width:100%}._ay{width:24px}._bs{width:100px}._bv{width:64px}._cp{width:70px}._d2{width:18px}._cf{padding:0}._i{padding:8px}._aw{padding:16px}._b1{padding:32px 16px}._j{color:#000000}._o{color:#FFFFFF}._bd{color:#1C5C9A}._cs{color:#525760}._d6{color:#CC0000}._k{font-size:14px}._as{font-size:24px}._b7{font-size:16px}._c9{font-size:12px}._ci{font-size:18px}._l{line-height:16px}._at{line-height:32px}._b8{line-height:20px}._ca{line-height:24px}._m{pointer-events:none}._p{background-color:#CC0000}._q{background-color:#F09400}._r{background-color:#57A757}._bi{background-color:#AAE5D3}._cz{background-color:#FFFFFF}._d9{background-color:#000000}._s{-moz-box-sizing:border-box}._t{box-sizing:border-box}._u{display:-webkit-box}._v{display:-moz-box}._w{display:-ms-flexbox}._x{display:-webkit-flex}._y{display:flex}._ax{display:inline-block}._cb{display:block}._z{-webkit-flex-wrap:nowrap}._a0{-ms-flex-wrap:nowrap}._a1{-webkit-box-lines:nowrap}._a2{flex-wrap:nowrap}._a3{-webkit-box-flex:1}._a4{-webkit-flex:1 0 auto}._a5{-ms-flex:1 0 auto}._a6{flex:1 0 auto}._a7{-webkit-align-content:space-between}._a8{-ms-flex-line-pack:justify}._a9{align-content:space-between}._aa{-webkit-justify-content:space-between}._bw{-webkit-justify-content:flex-end !important}._c1{-webkit-justify-content:center}._ab{-ms-flex-pack:justify}._bx{-ms-flex-pack:flex-end !important}._c2{-ms-flex-pack:center}._ac{-webkit-box-pack:justify}._by{-webkit-box-pack:flex-end !important}._c3{-webkit-box-pack:center}._ad{justify-content:space-between}._bz{justify-content:flex-end !important}._c4{justify-content:center}._ae{-webkit-flex-direction:column}._an{-webkit-flex-direction:row}._af{-ms-flex-direction:column}._ao{-ms-flex-direction:row}._ag{-webkit-box-orient:vertical}._ap{-webkit-box-orient:horizontal}._ah{-webkit-box-direction:normal}._ai{flex-direction:column}._aq{flex-direction:row}._aj{-webkit-align-items:stretch}._c5{-webkit-align-items:center}._ak{-ms-flex-align:stretch}._c6{-ms-flex-align:center}._al{-webkit-box-align:stretch}._c7{-webkit-box-align:center}._am{align-items:stretch}._c8{align-items:center}._av{margin:0}._ar{margin:0 auto}._b9{font-weight:500}._au{font-weight:normal}._b0{max-width:360x}._bh{max-width:360px}._b2{padding-left:24px}._b3{padding-right:24px}._ct{padding-right:8px}._b4{padding-top:16px}._ba{padding-top:24px}._cn{padding-top:8px}._b5{padding-bottom:16px}._bb{padding-bottom:24px}._c0{padding-bottom:40px}._co{padding-bottom:8px}._b6{margin-top:48px}._d7{margin-top:8px}._bc{text-decoration:none}._be{margin-left:-16px}._bf{margin-right:-16px}._cr{margin-right:8px}._bg{margin-bottom:-8px}._cc{margin-bottom:4px}._bj{background-size:40px}._bk{background-image:url("data:image/svg+xml;utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cg fill='none' stroke='%2339A6A8'%3E%3Cpath stroke-width='.8' d='M0 56c6 0 8 0 12-4l4-4 4-4c8-8 8-16 0-24l-4-4-4-4C8 8 6 8 0 8m64 48c-6 0-8 0-12-4l-4-4-4-4c-8-8-8-16 0-24l4-4 4-4c4-4 8-4 12-4M8 0c0 6 0 8 4 12l4 4 4 4c8 8 16 8 24 0l4-4 4-4c4-4 4-8 4-12m0 64c0-6 0-8-4-12l-4-4-4-4c-8-8-16-8-24 0l-4 4-4 4c-4 4-4 8-4 12'/%3E%3Cpath stroke-width='.4' d='M44 12l8 8c8 8 8 16 0 24l-8 8c-8 8-16 8-24 0l-8-8c-8-8-8-16 0-24l8-8c8-8 16-8 24 0m20 12c-6 0-8 0-12-4l-4-4-4-4c-4-4-4-8-4-12M24 64c0-6 0-8-4-12l-4-4-4-4c-4-4-8-4-12-4m0-16c6 0 8 0 12-4l4-4 4-4c4-4 4-8 4-12m16 64c0-4.8 0-8 4-12l4-4 4-4c4-4 8-4 12-4'/%3E%3C/g%3E%3C/svg%3E")}._bm{background-repeat:repeat-x}._bn{box-shadow:0 8pt 16pt rgba(0, 0, 0, 0.2)}._bo{-webkit-flex-grow:0 !important}._bp{-ms-flex-positive:0 !important}._bq{flex-grow:0 !important}._br{background:#000000}._cw{background:none}._bu{z-index:10}._cd{border-bottom:2px solid #F9F9F9}._cg{border:0}._cx{border:none}._ch{border-radius:0px}._cj{outline:0}._cy{outline:none}._ck{-webkit-font-smoothing:antialiased}._cl{-webkit-transition:all 200ms ease}._cm{transition:all 200ms ease}._cq{overflow:hidden}._cu{opacity:0.5}._cv{-webkit-appearance:none}._d0{fill:#000000}._d3{-webkit-transform:rotate(180deg)}._d4{-ms-transform:rotate(180deg)}._d5{transform:rotate(180deg)}</style>

<div id="app-content">
<div class="simple-container">
    <a href="{% url 'wodplannerapp:index' %}"><img src="{% static 'wodplannerapp/images/carabao_logo.png' %}" alt="Carabao" width="256" height="154"></a>

    <form id="form-container" method="post" action="{% url 'wodplannerapp:definewod' schema_key %}">
    {% csrf_token %}
        <div class="date-header">
            <h1>Datum: {{ form_strength.date }}</h1>
            <hr>
        </div>
        <!-- ------------------------------------------------------------------------------------------------------ -->

        <h1>Strength/Skill:</h1>
        <div class="descr">
            Anzahl Sets:
        </div>
        <div class="mycontent">
            <div id="sets-number" class="rounds">5</div>
            <div class="rounds">
            <img src="{% static 'wodplannerapp/images/add.png' %}" alt="add" width="16" height="16" id="add-set">
            <img src="{% static 'wodplannerapp/images/remove.png' %}" alt="add" width="16" height="16" id="remove-set">
            </div>
        </div>

        <div class="descr">
            Reps pro Set:
        </div>
        <div class="mycontent"></div>
        {{ form_reps.management_form }}
        {% for form in form_reps %}
            <div class="reps-strength-form">
                <div class="descr"></div>
                <div class="mycontent">
                    {{ form.number_reps }}
                </div>
            </div>
        {% endfor %}
        <div class="rep-identify"></div>

        <div class="descr">
            Anzahl Übungen:
        </div>
        <div class="mycontent">
            <div id="movement-number" class="rounds">1</div>
            <div class="rounds">
            <img src="{% static 'wodplannerapp/images/add.png' %}" alt="add" width="16" height="16" id="add-movement">
            <img src="{% static 'wodplannerapp/images/remove.png' %}" alt="add" width="16" height="16" id="remove-movement">
            </div>
        </div>

        <div class="descr">
            Übung:
        </div>
        {{ form_strength_movement.management_form }}
        {% for form in form_strength_movement %}
            <div class="movement-strength-form">
                <div class="descr"></div>
                <div class="mycontent">
                    {{ form.movement_name }}
                </div>
            </div>
        {% endfor %}
        <div class="move-identify"></div>

        <div class="strength-type">
            <div class="descr">
                Belastungsart:
            </div>
            <div class="mycontent">
                {{ form_strength.strength_type }}
            </div>
        </div>

        <div class="strength-comment">
            <div class="descr">
                Kommentar:
            </div>
            <div class="mycontent">
                {{ form_strength.strength_comment }}
            </div>
        </div>

        <hr>

        <!-- ------------------------------------------------------------------------------------------------------ -->
        <div class="wod-part">
            <h1>{{ wod_type }}:</h1>

                    <div>
            <div class="descr">
                {{ form_wod.wod_time_rounds.label }}:
            </div>
            <div class="mycontent">
                {{ form_wod.wod_time_rounds }}
            </div>
        </div>

        </div>
        <input type="submit" value="Erstellen" name="save" class="button">
    </form>
</div>
</div>

<script>
    let container = document.querySelector("#form-container")
    let addSetButton = document.querySelector("#add-set")
    let removeSetButton = document.querySelector("#remove-set")
    let numberSets = document.querySelector("#sets-number")
    let numberMovement = document.querySelector("#movement-number")
    let repsForm = document.querySelectorAll(".reps-strength-form")
    let repsMovement = document.querySelectorAll(".movement-strength-form")
    let repIdentifier = document.querySelector(".rep-identify")
    let moveIdentifier = document.querySelector(".move-identify")
    let totalRepForms = document.querySelector("#id_reps-TOTAL_FORMS")
    let totalMoveForms = document.querySelector("#id_strengthmove-TOTAL_FORMS")

    let addMovementButton = document.querySelector("#add-movement")
    let removeMovementButton = document.querySelector("#remove-movement")

    let setsNum = repsForm.length
    let movNum = repsMovement.length


    addSetButton.addEventListener('click', addSet)
    addSetButton.addEventListener('mouseover',function(e){
                                                let cursor = e.target.style.cursor;
                                                console.log(cursor);

                                              });
    removeSetButton.addEventListener('click', removeSet)

    addMovementButton.addEventListener('click', addMovement)
    removeMovementButton.addEventListener('click', removeMovement)

    function addSet(e) {
        e.preventDefault()

        let newRepForm = repsForm[0].cloneNode(true)
        let formRepRegex = RegExp(`reps-(\\d){1}-`,'g')

        setsNum++
        newRepForm.innerHTML = newRepForm.innerHTML.replace(formRepRegex, `reps-${setsNum-1}-`)

        totalRepForms.setAttribute('value', `${setsNum}`)
        numberSets.innerHTML = setsNum.toString()

        container.insertBefore(newRepForm, repIdentifier)


    }
    function removeSet(e) {
        e.preventDefault()
        if (setsNum > 1) {
            setsNum--
            numberSets.innerHTML = setsNum.toString()

            let allRepElements = document.querySelectorAll(".reps-strength-form")
            let lastRepElement = allRepElements[allRepElements.length - 1]

            lastRepElement.parentNode.removeChild(lastRepElement)
            totalRepForms.setAttribute('value', `${setsNum}`)
        }
    }

    function addMovement(e) {
        e.preventDefault()

        let newMoveForm = repsMovement[0].cloneNode(true)
        let formRepRegex = RegExp(`strengthmove-(\\d){1}-`,'g')

        movNum++
        newMoveForm.innerHTML = newMoveForm.innerHTML.replace(formRepRegex, `strengthmove-${movNum-1}-`)
        totalMoveForms.setAttribute('value', `${movNum}`)

        container.insertBefore(newMoveForm, moveIdentifier)
        numberMovement.innerHTML = movNum.toString()
    }

    function removeMovement(e) {
        e.preventDefault()

        if (movNum > 1) {
            movNum--

            let allMoveElements = document.querySelectorAll(".movement-strength-form")
            let lastMoveElement = allMoveElements[allMoveElements.length - 1]

            lastMoveElement.parentNode.removeChild(lastMoveElement)
            totalMoveForms.setAttribute('value', `${movNum}`)
            numberMovement.innerHTML = movNum.toString()
        }
    }
</script>

